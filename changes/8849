Improving runtime and memory usage
